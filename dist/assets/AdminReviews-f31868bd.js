import{r as e,j as a,ah as t,J as r,p as s,L as i,af as l,ai as n,aj as o}from"./vendor-c3bf04c7.js";import{u as d}from"./i18n-271c24bf.js";import{m as c}from"./framer-motion-6b213e1a.js";const m=()=>{const{i18n:m}=d(),[x,p]=e.useState(!1),[u,b]=e.useState(""),[g,h]=e.useState([]),[y,f]=e.useState(!1),[j,N]=e.useState(null),w=async()=>{f(!0);try{const e=await fetch(`/api/admin_get_reviews.php?token=${u}`,{headers:{Authorization:u}}),a=await e.json();"success"===a.status?(h(a.data),p(!0)):N({type:"error",text:a.message})}catch(e){N({type:"error",text:"Error de conexi칩n"})}finally{f(!1)}},v=async(e,a)=>{try{const t=await fetch("/api/admin_update_review.php",{method:"POST",headers:{Authorization:u,"Content-Type":"application/json"},body:JSON.stringify({id:e,token:u,...a})});"success"===(await t.json()).status&&(N({type:"success",text:"Rese침a actualizada"}),w())}catch(t){N({type:"error",text:"Error al actualizar"})}};return x?a.jsx("div",{className:"min-h-screen bg-bg-light dark:bg-bg-dark pt-32 pb-24 px-6",children:a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-12",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-black mb-2",children:"Gesti칩n de Rese침as"}),a.jsx("p",{className:"text-gray-500 font-medium",children:"Administra y aprueba los comentarios de los clientes"})]}),a.jsx("button",{onClick:()=>window.location.reload(),className:"text-sm font-bold text-primary hover:underline",children:"Cerrar Sesi칩n"})]}),j&&a.jsx("div",{className:"mb-8 p-4 rounded-xl text-center font-bold "+("success"===j.type?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:j.text}),a.jsx("div",{className:"grid gap-6",children:g.map(e=>a.jsxs(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white dark:bg-white/5 p-6 rounded-[2rem] border border-black/5 flex flex-col md:flex-row gap-8 items-start md:items-center shadow-lg",children:[a.jsxs("div",{className:"relative group shrink-0",children:[a.jsx("div",{className:"w-24 h-24 rounded-2xl overflow-hidden bg-gray-100 dark:bg-white/10 flex items-center justify-center border-2 border-primary/20",children:e.foto_url?a.jsx("img",{src:e.foto_url,className:"w-full h-full object-cover",alt:""}):a.jsx(r,{size:32,className:"text-gray-300"})}),a.jsxs("label",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center cursor-pointer rounded-2xl",children:[a.jsx(r,{className:"text-white",size:24}),a.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:a=>(async(e,a)=>{const t=new FormData;t.append("id",e),t.append("token",u),t.append("photo",a);try{const e=await fetch("/api/admin_upload_photo.php",{method:"POST",headers:{Authorization:u},body:t}),a=await e.json();"success"===a.status?(w(),N({type:"success",text:"Foto subida correctamente"})):N({type:"error",text:a.message})}catch(r){N({type:"error",text:"Error al subir la foto"})}})(e.id,a.target.files[0])})]})]}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h3",{className:"text-xl font-black",children:e.nombre}),a.jsxs("span",{className:"px-3 py-1 bg-primary/10 text-primary text-xs font-bold rounded-full uppercase flex items-center gap-2",children:[{ar:"游뷣릖",cl:"游뻟릖",co:"游뻟릖",es:"游쀯릖",mx:"游쓇릖",pe:"游왫릖",uy:"游쥟릖",us:"游쥟릖"}[e.pais]||"游깷",e.tour_id]})]}),a.jsx("div",{className:"flex gap-1 text-yellow-400 mb-3",children:[...Array(5)].map((t,r)=>a.jsx(s,{size:14,fill:r<e.estrellas?"currentColor":"transparent"},r))}),a.jsxs("div",{className:"mt-8 space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-[10px] font-black uppercase text-gray-400 tracking-widest flex items-center gap-2",children:"Original (ES)"}),a.jsx("textarea",{id:`orig-${e.id}`,className:"w-full p-4 bg-gray-50 dark:bg-white/5 border border-black/5 rounded-xl text-sm outline-none focus:ring-1 focus:ring-primary h-24 italic",defaultValue:e.comentario||"",placeholder:"Comentario original..."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"text-[10px] font-black uppercase text-pink-500 tracking-widest flex items-center gap-2",children:[a.jsx(i,{size:12}),"en"===(null==m?void 0:m.language)?"Translation (EN)":"Traducci칩n (EN)"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("textarea",{id:`trans-${e.id}`,className:"w-full p-4 bg-gray-50 dark:bg-white/5 border border-black/5 rounded-xl text-sm outline-none focus:ring-1 focus:ring-primary h-24 italic",defaultValue:e.comentario_en||"",placeholder:"Traduce el comentario aqu칤..."}),a.jsx("button",{onClick:()=>{const a=document.getElementById(`orig-${e.id}`).value,t=document.getElementById(`trans-${e.id}`).value;v(e.id,{aprobado:e.aprobado,comentario:a,comentario_en:t})},className:"self-end p-4 bg-primary/10 text-primary rounded-xl hover:bg-primary hover:text-white transition-all shadow-sm",title:"Guardar Cambios",children:a.jsx(l,{size:20})})]})]})]}),e.ig_user&&a.jsxs("p",{className:"text-xs text-primary font-bold mt-2",children:["IG: @",e.ig_user.replace("@","")]}),a.jsxs("div",{className:"inline-flex items-center gap-2 mt-4 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider "+(1==e.autorizacion_fotos?"bg-blue-50 text-blue-600 border border-blue-100":"bg-red-50 text-red-600 border border-red-100"),children:[a.jsx(l,{size:12}),1==e.autorizacion_fotos?"Autoriza Web/Redes":"No Autoriza Redes"]})]}),a.jsx("div",{className:"flex gap-3 shrink-0",children:a.jsx("button",{onClick:()=>{const a=document.getElementById(`orig-${e.id}`).value,t=document.getElementById(`trans-${e.id}`).value,r="1"===e.aprobado||1===e.aprobado?0:1;v(e.id,{aprobado:r,comentario:a,comentario_en:t})},className:"flex items-center gap-2 px-6 py-3 rounded-xl font-bold transition-all "+("1"===e.aprobado||1===e.aprobado?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-500 hover:bg-gray-200"),children:"1"===e.aprobado||1===e.aprobado?a.jsxs(a.Fragment,{children:[a.jsx(n,{size:18})," Ocultar"]}):a.jsxs(a.Fragment,{children:[a.jsx(o,{size:18})," Visualizar"]})})})]},e.id))}),0===g.length&&!y&&a.jsx("div",{className:"text-center py-24 bg-gray-50 dark:bg-white/5 rounded-[3rem] border border-dashed border-gray-200 dark:border-white/10",children:a.jsx("p",{className:"text-gray-400 font-medium",children:"No hay rese침as para gestionar a칰n"})})]})}):a.jsx("div",{className:"min-h-screen bg-bg-light dark:bg-bg-dark pt-32 px-6 flex items-center justify-center",children:a.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-white/5 p-8 rounded-[2.5rem] border border-black/5 shadow-2xl",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"w-16 h-16 bg-primary/10 text-primary rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(t,{size:32})}),a.jsx("h1",{className:"text-2xl font-black",children:"Panel de Control"}),a.jsx("p",{className:"text-gray-500",children:"Introduce la contrase침a de administrador"})]}),a.jsxs("form",{onSubmit:e=>{e.preventDefault(),w()},className:"space-y-4",children:[a.jsx("input",{type:"password",className:"w-full px-6 py-4 bg-gray-50 dark:bg-white/5 border border-black/10 rounded-2xl outline-none focus:ring-2 focus:ring-primary",placeholder:"Contrase침a",value:u,onChange:e=>b(e.target.value)}),a.jsx("button",{className:"btn-primary w-full py-4 text-lg font-bold",children:"Entrar"})]}),j&&a.jsx("p",{className:"mt-4 text-center text-red-500 font-medium",children:j.text})]})})};export{m as default};
